<?xml version="1.0" encoding="windows-1251" standalone="yes" ?>
<triggers>

	<trigger	Name="GlobalVar"	active="1">
		<event	timeout="0.1"		eventid="GE_TIME_PERIOD" />
		<script>
			SetVar("globalEnterToPesht",1)

			trigger:Deactivate()
		</script>
	</trigger>


	
	<trigger	Name="trVaterlandPlaceSecret"	active="1">
		<event	timeout="0.1"			eventid="GE_TIME_PERIOD" />
		<script>
			local gunlist = {"specter01","storm01","pkt01","hornet01","vector01","vulcan01","hurricane01"}
			local len = getn(gunlist)

			for i=1,12 do
				--println("step"..i.."succesful")
				CreateBoxWithAffixGun(CVector(getPos("SecretPlace"..i.."_loc")), gunlist[exrandom(len)], random(0, 2))
			end
			trigger:Deactivate()
		</script>
	</trigger>


	<trigger	Name="trAutoSave"	active="0">
		<event eventid="GE_GAME_START" ObjName="Player1" />
		<script>
		</script>
	</trigger>





	<trigger	Name="trStartMap"	active="1">
		<event eventid="GE_GAME_START" ObjName="Player1" />
		<script>
			if IsQuestTaken("d_FindVrata_Quest") then

				SetCoordinateForQuest( "r2m2_GiveDisk2ToOrakul" , CVector(getPos("ToR1M4")))

				trigger:Deactivate()

			else 
				SetCoordinateForQuest( "r2m2_GiveDisk2ToOrakul" , CVector(getPos("ToR2M1")))

				trigger:Deactivate()
			end
		</script>
	</trigger>




	<trigger Name="tr_Start0" active="1">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
			if IsQuestTaken("d_FindRealFatherRoom_Quest") then
				local tp = GetEntityByName("Pesht")
				if tp then
					tp:SetOpenGateToPlayer( false )
				end
			else
				local tp = GetEntityByName("Pesht")
				if tp then
					tp:SetOpenGateToPlayer( true )
				end
			end

			SetConditionalClosingForTown( "Pesht", "r1m3", true )

			CreateNewDummyObject( "arena_barricade8", "zagr1", -1, -1, CVector(5523.000, 217, 1423.368), Quaternion(0.000, -0.706, 0.000, 0.709), 0)
			CreateNewDummyObject( "arena_barricade8", "zagr2", -1, -1, CVector(5631.000, 217, 1422.771), Quaternion(0.000, -0.706, 0.000, 0.709), 0)

			CreateNewDummyObject( "bridge_military", "BridgeForDestroy", -1, -1, CVector(5576.837, 202.7, 1423.237), Quaternion(0.0000, 0.7086, 0.0000, 0.7056), 0)

			CreateNewSgNodeObject("ET_PS_HOUSE_MED_FIRE", "FIRE01", -1, -1, CVector(4214.315, 231.049, 1020.738), Quaternion(0.0000, 0.0000, 0.0000, 1.0000))
			CreateNewSgNodeObject("ET_PS_HOUSE_MED_FIRE", "FIRE02", -1, -1, CVector(4136.448, 252.076, 834.866), Quaternion(0.0000, 0.0000, 0.0000, 1.0000))
			CreateNewSgNodeObject("ET_PS_HOUSE_MED_FIRE", "FIRE03", -1, -1, CVector(4183.487, 235.000, 1217.818), Quaternion(0.0000, 0.0000, 0.0000, 1.0000))
			CreateNewSgNodeObject("ET_PS_HOUSE_MED_FIRE", "FIRE04", -1, -1, CVector(4043.283, 235.428, 723.935), Quaternion(0.0000, 0.0000, 0.0000, 1.0000))
			CreateNewSgNodeObject("ET_PS_HOUSE_MED_FIRE", "FIRE05", -1, -1, CVector(4045.008, 234.819, 1037.936), Quaternion(0.0000, 0.0000, 0.0000, 1.0000))
			CreateNewSgNodeObject("ET_PS_HOUSE_MED_FIRE", "FIRE06", -1, -1, CVector(4221.199, 231.304, 1010.331), Quaternion(0.0000, 0.0000, 0.0000, 1.0000))

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="tr_OpenTownAndShowButtonInPesht" active="0">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
			local tp = GetEntityByName("Pesht")
			if tp then
				tp:SetOpenGateToPlayer( true )
			end

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="tr_PeshtTrue" active="1">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="locPeshtTrue" />
		<event eventid="GE_OBJECT_IN_LOCATION" ObjName="locPeshtTrue" />
		<script>
			SetVar("globalEnterToPesht",1)
		</script>
	</trigger>

	<trigger Name="tr_PeshtFalse" active="1">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="locPeshtFalse" />
		<event eventid="GE_OBJECT_IN_LOCATION" ObjName="locPeshtFalse" />
		<script>
			SetVar("globalEnterToPesht",-1)
		</script>
	</trigger>

	<trigger Name="tr_LeavePesht" active="1">
		<event eventid="GE_TOWN_CONDITIONAL_CLOSING" ObjName="Pesht" />
		<script>
			if IsQuestComplete("d_DestroyBridge_Quest") then
				local b = SpawnMessageBox( "8804" )
				if b == 1 then
					local a = (-1)*(GetVar("globalEnterToPesht").AsInt)
					SetVar("globalEnterToPesht",a)

					TActivate ("tr_RolikAndPosLeavePesht")
				else
					TActivate ("tr_RolikAndPosLeavePesht")
				end
			else
				local b = SpawnMessageBox( "8805" )
				if b == 1 then
					if GetPlayerMoney() >= 250 then
						AddPlayerMoney( -250 )

						local a = (-1)*(GetVar("globalEnterToPesht").AsInt)
						SetVar("globalEnterToPesht",a)

						TActivate ("tr_RolikAndPosLeavePesht")
					else
						SpawnMessageBox( "6006" )	

						TActivate ("tr_RolikAndPosLeavePesht")			
					end
				else
					TActivate ("tr_RolikAndPosLeavePesht")
				end
			end
		</script>
	</trigger>

	<trigger Name="tr_RolikAndPosLeavePesht" active="0">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
			LeaveTown()

			CinemaFiltersUse()

			local Plf = GetPlayerVehicle()
			local PlfID = GetPlayerVehicleId()
			local PlfCoor = Plf:GetPosition()
			PlfCoor.y = PlfCoor.y + 75
			PlfCoor.z = PlfCoor.z + 15

			Plf:SetCustomControlEnabled( true )
			Plf:SetCustomLinearVelocity( 0 )
			Plf:SetThrottle( 0 )
			Plf:SetCustomControlEnabled( false )

			FlyAround(6, 0, 10, 5, PlfCoor, PlfID, 0, 1)
			StartCinematic()

			local a = GetVar("globalEnterToPesht").AsInt
			if a == 1 then
				Plf:SetCustomControlEnabled( true ) 
				Plf:SetGamePositionOnGround( CVector(3912.081, 245, 3718.224))
				Plf:SetRotation(Quaternion(-0.059, -0.707, -0.033, 0.704))
				Plf:SetExternalPathByName("pesht_true")
				Plf:SetCustomControlEnabled( false )  

				TActivate( "tr_RolikAndPosLeavePesht_true" )    
			else
				Plf:SetCustomControlEnabled( true ) 
				Plf:SetGamePositionOnGround( CVector(4224.247, 245, 3705.479))
				Plf:SetRotation(Quaternion(0.039, 0.778, -0.046, 0.626))
				Plf:SetExternalPathByName("pesht_false")
				Plf:SetCustomControlEnabled( false ) 

				TActivate( "tr_RolikAndPosLeavePesht_false" )     
			end

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="tr_RolikAndPosLeavePesht_true" active="0">
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<script>
			GameFiltersUse()

			local Plf = GetPlayerVehicle()
			Plf:SetCustomControlEnabled( true )
			Plf:SetCustomLinearVelocity( 0 )
			Plf:SetThrottle( 0 )
			Plf:SetRotation(Quaternion(-0.059, -0.707, -0.033, 0.704))
			Plf:PlaceToEndOfPath("pesht_true")
			Plf:SetCustomControlEnabled( false )

			SetCameraBehindPlayerVehicle()

			trigger:Deactivate() 
		</script>
	</trigger>

	<trigger Name="tr_RolikAndPosLeavePesht_false" active="0">
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<script>
			GameFiltersUse()

			local Plf = GetPlayerVehicle()
			Plf:SetCustomControlEnabled( true )
			Plf:SetCustomLinearVelocity( 0 )
			Plf:SetThrottle( 0 )
			Plf:SetRotation(Quaternion(0.039, 0.778, -0.046, 0.626))
			Plf:PlaceToEndOfPath("pesht_false")
			Plf:SetCustomControlEnabled( false )

			SetCameraBehindPlayerVehicle()

			trigger:Deactivate() 
		</script>
	</trigger>




	<trigger Name="SHAHTSBANDIT" active="0">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
			TeamCreate("ShahtsBoss",1002,CVector(2202, 285, 6936),{"Sml301","r1m3_Fighter01","Sml401"}, CVector(2041, 287, 7182), 1)

			TakeQuest( "d_BombShahtsAtakBandits_Quest" )

			TActivate("SHAHTSBANDITBOSSDIE")

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="SHAHTSBANDITBOSSDIE" active="0">
		<event eventid="GE_OBJECT_DIE" ObjName="ShahtsBoss" />
		<script>
   			CompleteQuest( "d_BombShahtsAtakBandits_Quest" )

			trigger:Deactivate()
		</script>
	</trigger>





	<trigger Name="BOOOM" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="TheDestroyBridgeLoc" />
		<script>
  			if IsQuestTaken("d_DestroyBridge_Quest") then
				RemoveQuestItem("quest_explosive")

   				CompleteQuest( "d_DestroyBridge_Quest" )

				local a = GetEntityByName("BaseGuardian_enter")
				if a then a:SetProperty("Active",0) end

				TActivate( "RolikBegin_BOOOM" )

				trigger:Deactivate()
  			end
		</script>
	</trigger>





	<trigger Name="BASEATTACK" active="0">
		<event timeout="0" eventid="GE_TIME_PERIOD"/>
		<script>
			local rrr = GetEntityByName ("zagr1")
			if rrr then rrr:Remove() end
			local rrr = GetEntityByName ("zagr2")
			if rrr then rrr:Remove() end

			local a = GetEntityByName("BaseGuardian_enter")
			if a then a:SetProperty("Active",0) end

			TActivate( "BASEATTACKEND" )

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="BASEATTACKEND" active="0">
		<event eventid="GE_OBJECT_LEAVES_LOCATION" ObjName="BaseGuardianLoc_out" />
		<script>
			CreateNewDummyObject( "arena_barricade8", "zagr1", -1, -1, CVector(5523.000, 217, 1423.368), Quaternion(0.0000, -0.7056, 0.0000, 0.7086), 0)
			CreateNewDummyObject( "arena_barricade8", "zagr2", -1, -1, CVector(5631.000, 217, 1422.771), Quaternion(0.0000, -0.7056, 0.0000, 0.7086), 0)

			local a = GetEntityByName("BaseGuardian_enter")
			if a then a:SetProperty("Active",1) end

			trigger:Deactivate()
		</script>
	</trigger>





	<trigger Name="FATHERHOUSE" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="HouseLoc" />
		<script>
 			if  IsQuestTaken("d_FatherRoomInMinin_Quest") and not(IsQuestComplete("d_FatherRoomInMinin_Quest")) then
				TActivate( "RolikBegin_FATHERHOUSE" )

   				CompleteQuest( "d_FatherRoomInMinin_Quest" )

				AddHistory( "r1_Father_Room_00" )
				AddFadingMsgId( "fm_history_got" )
				AddQuestItem("quest_key_for_submarine")
			end

			if  IsQuestTaken("r3m2_RideToFatherRoomAfterOracul") and not(IsQuestComplete("r3m2_RideToFatherRoomAfterOracul")) then
				TActivate( "RolikBegin_FATHERHOUSERETURN" )

   				CompleteQuest( "r3m2_RideToFatherRoomAfterOracul" )
			end
		</script>
	</trigger>





<!-- освобождение вышки -->
	<trigger Name="ATTACKOILMINE" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="TheBanditOilMine_defend" />
		<script>
			TActivate("PlayerAndBanditsOilCas")

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="BOSSOILMINEDIE" active="0">
		<event eventid="GE_OBJECT_DIE" ObjName="OilMineBoss" />
		<script>

			SetTolerance( 1100, 1047, RS_NEUTRAL )
			SaveAllToleranceStatus(RS_NEUTRAL)

			TeamCreate("OilMineRuner",1044,CVector(6959, 260, 7059),{"DemoBandit"}, nil, 1)
			
			local runVeh = getObj("OilMineRuner_vehicle_0")
			local RunID = runVeh:GetId()
			local Plf = GetPlayerVehicle()
			local PlfID = GetPlayerVehicleId()

			if runVeh then
				runVeh:SetSkin(1)
			end
			
			FlyLinked( "OilMineRunner_cam01", PlfID, 13, 1, 1, RunID )
			StartCinematic()
			
			TActivate( "BOSSOILMINEDIE_FADEIN" )
			TActivate( "BOSSOILMINENDCINIMATIC" )

			CompleteQuest( "d_DriveBanditFromOilMine_Quest" )

			trigger:Deactivate()
			
		</script>
	</trigger>
		
	<trigger Name="BOSSOILMINEDIE_FADEIN" active="0">
		<event eventid="GE_CINEMATIC_ENTER_FADE_IN" ObjName="Player1" />
		<script>	
			local runVeh = getObj("OilMineRuner_vehicle_0")
			local Plf = GetPlayerVehicle()
			local PlfCoor = Plf:GetPosition()
			PlfCoor.y = PlfCoor.y + 10
			PlfCoor.z = PlfCoor.z + 20

			if runVeh then
				runVeh:SetExternalPathByName("oilminerunner_path")
				runVeh:SetCruisingSpeed(10)
			end

			if Plf then
				Plf:SetCustomControlEnabled( true )
				Plf:SetCustomLinearVelocity( 0 )
				Plf:SetThrottle( 0 )
				Plf:SetCustomControlEnabled( false )
				Plf:SetGamePositionOnGround(CVector(6984.255, 263.272, 7091.308))
				Plf:SetRotation(Quaternion(0.0000, -0.9063, 0.0000, 0.4226))
			end

			AddCinematicMessage( 20, 1 )
						
			trigger:Deactivate()
		</script>
	</trigger>
	
	<trigger Name="BOSSOILMINENDCINIMATIC" active="0">
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<script>
			GameFiltersUse()

			RestoreAllToleranceStatus()

			local vehP = GetEntityByName("OilMineRuner_vehicle_0")
			if vehP then
				vehP:PlaceToEndOfPath("oilminerunner_path")
				vehP:SetExternalPathByName("banditoilmine_path")
			end
			
			TActivate("RUNTORUNER")
			TActivate("RUNTORUNERENDRACE")

			SetCameraBehindPlayerVehicle()

			SetTolerance( 1100, 1044, RS_ENEMY )

			trigger:Deactivate() 
		</script>
	</trigger>




<!-- слежка за бандитом -->
	<trigger Name="RUNTORUNER" active="0">
		<event timeout="1" eventid="GE_TIME_PERIOD" />
		<script>
			local run = GetEntityByName("OilMineRuner_vehicle_0")
			local pl = GetPlayerVehicle()
			local len

			if run and run:IsAlive() then
				len = Dist(pl, run)

				if (len > 305) or (15 > len) then
					CinemaFiltersUse()

					SaveAllToleranceStatus(RS_NEUTRAL)

					local Plf = GetPlayerVehicle()
					local PlfID = GetPlayerVehicleId()
					local PlfCoor = Plf:GetPosition()
					PlfCoor.y = PlfCoor.y + 25*0.74
					PlfCoor.z = PlfCoor.z + 25*0.74

					Plf:SetCustomControlEnabled( true )
					Plf:SetCustomLinearVelocity( 0 )
					Plf:SetThrottle( 0 )
					Plf:SetCustomControlEnabled( false )

					FlyAround(6, 0, 25, 6, PlfCoor, PlfID, 1, 1)
					StartCinematic()

					AddCinematicMessage( 18, 1 )

					TActivate("RUNTORUNER_cp")

					TDeactivate("RUNTORUNERENDRACE")

					trigger:Deactivate()
				end
			else
				CinemaFiltersUse()

				SaveAllToleranceStatus(RS_NEUTRAL)

				local Plf = GetPlayerVehicle()
				local PlfID = GetPlayerVehicleId()
				local PlfCoor = Plf:GetPosition()
				PlfCoor.y = PlfCoor.y + 25*0.74
				PlfCoor.z = PlfCoor.z + 25*0.74

				Plf:SetCustomControlEnabled( true )
				Plf:SetCustomLinearVelocity( 0 )
				Plf:SetThrottle( 0 )
				Plf:SetCustomControlEnabled( false )

				FlyAround(6, 0, 25, 6, PlfCoor, PlfID, 1, 1)
				StartCinematic()

				AddCinematicMessage( 38, 1 )

				TActivate("RUNTORUNER_cp")

				TDeactivate("RUNTORUNERENDRACE")

				trigger:Deactivate()
			end
		</script>
	</trigger>
	<trigger Name="RUNTORUNER_cp" active="0">
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<script>
			GameFiltersUse()

			RestoreAllToleranceStatus()

			local r = GetEntityByName ("OilMineRuner")
			if r then r:Remove() end

			FailQuestIfTaken("d_FindBanditBaseOfOilMine_Quest")

			SetCameraBehindPlayerVehicle()

			trigger:Deactivate() 
		</script>
	</trigger>

	<trigger Name="RUNTORUNERENDRACE" active="0">
		<event eventid="GE_TARGET_REACHED" ObjName="OilMineRuner_vehicle_0" />
		<script>
			TeamCreate("OilMineBaseBoss",1044,CVector(4483, 265, 7496),{"r1m3_Fighter01","r1m3_Fighter02"},CVector(4546, 263, 7479), 1)

			CompleteQuest("d_FindBanditBaseOfOilMine_Quest1")

			TActivate("KILLBOSSOILMINEBASE")

			TDeactivate("RUNTORUNER")

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="KILLBOSSOILMINEBASE" active="0">
		<event eventid="GE_OBJECT_DIE" ObjName="OilMineBaseBoss" />
		<script>
   			CompleteQuest( "d_FindBanditBaseOfOilMine_Quest2" )

			trigger:Deactivate()
		</script>
	</trigger>





<!-- слежка за мэром -->
	<trigger Name="SPYMER" active="0">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>

			TActivate("SPYMER_Start")

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="SPYMER_Start" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>
			TActivate( "RolikBegin_SPYMER" )

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="RUNMER" active="0">
		<event timeout="1" eventid="GE_TIME_PERIOD" />
		<script>
			local run = GetEntityByName("MerCar_vehicle_0")
			local pl = GetPlayerVehicle()
			local len

			if run and run:IsAlive()  then
				len = Dist(pl, run)
				if (len > 305) or (15 > len) then
					CinemaFiltersUse()

					SaveAllToleranceStatus(RS_NEUTRAL)

					local Plf = GetPlayerVehicle()
					local PlfID = GetPlayerVehicleId()
					local PlfCoor = Plf:GetPosition()
					PlfCoor.y = PlfCoor.y + 25*0.74
					PlfCoor.z = PlfCoor.z + 25*0.74

					Plf:SetCustomControlEnabled( true )
					Plf:SetCustomLinearVelocity( 0 )
					Plf:SetThrottle( 0 )
					Plf:SetCustomControlEnabled( false )

					FlyAround(6, 0, 25, 6, PlfCoor, PlfID, 1, 1)
					StartCinematic()

					AddCinematicMessage( 19, 1 )

					TActivate( "RUNMER_cp" )

					TDeactivate("RUNMEREND")

					trigger:Deactivate()
				end
			else
				CinemaFiltersUse()

				SaveAllToleranceStatus(RS_NEUTRAL)

				local Plf = GetPlayerVehicle()
				local PlfID = GetPlayerVehicleId()
				local PlfCoor = Plf:GetPosition()
				PlfCoor.y = PlfCoor.y + 25*0.74
				PlfCoor.z = PlfCoor.z + 25*0.74

				Plf:SetCustomControlEnabled( true )
				Plf:SetCustomLinearVelocity( 0 )
				Plf:SetThrottle( 0 )
				Plf:SetCustomControlEnabled( false )

				FlyAround(6, 0, 25, 6, PlfCoor, PlfID, 1, 1)
				StartCinematic()

				AddCinematicMessage( 37, 1 )

				TActivate( "RUNMER_cp" )

				TDeactivate("RUNMEREND")

				trigger:Deactivate()
			end
		</script>
	</trigger>
	<trigger Name="RUNMER_cp" active="0">
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<script>
			GameFiltersUse()

			RestoreAllToleranceStatus()

			local r = GetEntityByName ("MerCar")
			if r then r:Remove() end

			FailQuestIfTaken("d_MoveToMer_Quest")
			FailQuestIfTaken("d_FindWorkersToOilMine_Quest")

			TakeQuest("d_PayWorkersMoney_Quest")

			SetCameraBehindPlayerVehicle()

			trigger:Deactivate() 
		</script>
	</trigger>

	<trigger Name="RUNMEREND" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="TheSpy" />
		<script>
			TDeactivate("RUNMER")
			
			CompleteQuestIfTaken("d_MoveToMer_Quest")

			TActivate( "RolikBegin_THESPY" )

			trigger:Deactivate()
		</script>
	</trigger>





<!-- поиски лисы -->
	<trigger Name="BASEABOUTLISA" active="0">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
			local town = GetEntityByName ("TheBase")
			if town then town:SetOpenGateToPlayer(false) end

			TeamCreate("Argument",1002,CVector(6960,296,1056),{"r1m1_bug02","r1m1_scout03"},CVector(6965,295,1131), 1)

			TakeQuest("d_GiveProblemToBase_Quest")

			TActivate("ARGUMENDIE")

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="ARGUMENDIE" active="0">
		<event eventid="GE_OBJECT_DIE" ObjName="Argument" />
		<script>
			local town = GetEntityByName ("TheBase")
			if town then town:SetOpenGateToPlayer(true) end

			CinemaFiltersUse()

			SaveAllToleranceStatus(RS_NEUTRAL)

			local Plf = GetPlayerVehicle()
			local PlfID = GetPlayerVehicleId()
			local PlfCoor = Plf:GetPosition()
			PlfCoor.y = PlfCoor.y + 25*0.74
			PlfCoor.z = PlfCoor.z + 25*0.74

			Plf:SetCustomControlEnabled( true )
			Plf:SetCustomLinearVelocity( 0 )
			Plf:SetThrottle( 0 )
			Plf:SetCustomControlEnabled( false )

			FlyAround(6, 0, 25, 35, PlfCoor, PlfID, 1, 1)
			StartCinematic()

			AddCinematicMessage( 11, 1 )
			AddCinematicMessage( 12, 0.25 )
			AddCinematicMessage( 13, 0.25  )
			AddCinematicMessage( 14, 0.25  )
			AddCinematicMessage( 15, 0.25  )

			TActivate( "ARGUMENDIE_cp" )

   			CompleteQuest( "d_GiveProblemToBase_Quest" )

			AddHistory( "r1_About_Lisa_After_Base_00" )
			AddFadingMsgId( "fm_history_got" )

			trigger:Deactivate()
		</script>
	</trigger>
	<trigger Name="ARGUMENDIE_cp" active="0">
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<script>
			GameFiltersUse()

			RestoreAllToleranceStatus()

			SetCameraBehindPlayerVehicle()

			trigger:Deactivate() 
		</script>
	</trigger>




<!-- Узнать где туннель -->
	<trigger Name="TUNNELLOCATION" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="TunnelLoc" />
		<script>
			CompleteQuestIfTaken("d_FindDoorInTunel_Quest")

			TActivate("RolikBegin_Tunel")

			AddHistory( "r1_See_Tonnel_00" )
			AddFadingMsgId( "fm_history_got" )

			trigger:Deactivate()
		</script>
	</trigger>




<!-- Устроить засаду  -->
	<trigger Name="ZASADATUNEL" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="ZasadaLocQ" />
		<script>
   			
			TActivate( "RolikBegin_Zasada" )

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="RUNTOPIONEER" active="0">
		<event timeout="1" eventid="GE_TIME_PERIOD" />
		<script>
			local run = GetEntityByName("Pioneer_vehicle_0")
			local pl = GetPlayerVehicle()
			local len

			if run and run:IsAlive() then
				len = Dist(pl, run)

				if (15 > len) then
					SetTolerance( 1100, 1046, RS_ENEMY )

					local parentrun = GetEntityByName("Pioneer")
					if parentrun then
						parentrun:SetDestination(pl:GetPosition())
					end

					TDeactivate( "PIONEERASGARD" )

					trigger:Deactivate()

				elseif (len > 305) then
					SaveAllToleranceStatus(RS_NEUTRAL)

					local Plf = GetPlayerVehicle()
					local PlfID = GetPlayerVehicleId()
					local PlfCoor = Plf:GetPosition()
					PlfCoor.y = PlfCoor.y + 25*0.74
					PlfCoor.z = PlfCoor.z + 25*0.74

					Plf:SetCustomControlEnabled( true )
					Plf:SetCustomLinearVelocity( 0 )
					Plf:SetThrottle( 0 )
					Plf:SetCustomControlEnabled( false )

					FlyAround(6, 0, 25, 6, PlfCoor, PlfID, 1, 1)
					StartCinematic()

					AddCinematicMessage( 18, 1 )

					TActivate("PIONEERDEAD_cp")

					TDeactivate( "PIONEERASGARD" )
					TDeactivate("PIONEERDEAD")

					FailQuest("d_SerchCarTunel_Quest")


					trigger:Deactivate()
				end
			end
		</script>
	</trigger>

	<trigger Name="PIONEERDEAD" active="0">
		<event eventid="GE_OBJECT_DIE" ObjName="Pioneer" />
		<script>
			TDeactivate( "PIONEERASGARD" )
			TDeactivate( "RUNTOPIONEER" )
			TActivate( "TRIGGER_TUNNELOPEN" )

			CinemaFiltersUse()

			SaveAllToleranceStatus(RS_NEUTRAL)

			local Plf = GetPlayerVehicle()
			local PlfID = GetPlayerVehicleId()
			local PlfCoor = Plf:GetPosition()
			PlfCoor.y = PlfCoor.y + 25*0.74
			PlfCoor.z = PlfCoor.z + 25*0.74

			Plf:SetCustomControlEnabled( true )
			Plf:SetCustomLinearVelocity( 0 )
			Plf:SetThrottle( 0 )
			Plf:SetCustomControlEnabled( false )

			FlyAround(6, 0, 25, 8, PlfCoor, PlfID, 3, 1)
			StartCinematic()

			AddCinematicMessage(9, 2)

			TActivate( "PIONEERDEAD_cp" )

   			TakeQuest( "d_OpenTunel_Quest" )
   			FailQuest( "d_SerchCarTunel_Quest" )
			FailQuest("d_FindKeyInTunel_Quest")

			AddQuestItem("quest_key_for_tunnel")

			trigger:Deactivate()
		</script>
	</trigger>
	<trigger Name="PIONEERDEAD_cp" active="0">
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<script>
			GameFiltersUse()

			RestoreAllToleranceStatus()

			SetCameraBehindPlayerVehicle()

			local run = GetEntityByName("Pioneer_vehicle_0")
			if run then
				run:Remove()
			end

			trigger:Deactivate() 
		</script>
	</trigger>

	<trigger Name="PIONEERASGARD" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="PioneerLoc" />
		<script>
   			CompleteQuest( "d_SerchCarTunel_Quest" )
			FailQuest("d_FindKeyInTunel_Quest")

			TDeactivate( "PIONEERDEAD" )
			TDeactivate( "RUNTOPIONEER" )

			TActivate( "RolikBegin_PIONEERASGARD" )

			trigger:Deactivate()
		</script>
	</trigger>





	<trigger Name="TRIGGER_TUNNELOPEN" active="1">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="TunnelLoc" />
		<script>
			if  IsQuestTaken("d_OpenTunel_Quest") then
				local b = GetEntityByName("ToR2M1")
				if b then b:SetProperty("Active",1) end
			end
		</script>
	</trigger>





	<trigger Name="TRIGGER_THIEFWAR" active="0">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
			TeamCreate("ThiefCar",1002,CVector(6960,296,1056),{"UralShot"},CVector(6965,295,1131), 1)

			TakeQuest("r1m3_FightWithThief")

			TActivate("TRIGGER_THIEFDIE")

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="TRIGGER_THIEFDIE" active="0">
		<event eventid="GE_OBJECT_DIE" ObjName="ThiefCar" />
		<script>
			CinemaFiltersUse()

			SaveAllToleranceStatus(RS_NEUTRAL)

			local Plf = GetPlayerVehicle()
			local PlfID = GetPlayerVehicleId()
			local PlfCoor = Plf:GetPosition()
			PlfCoor.y = PlfCoor.y + 25*0.74
			PlfCoor.z = PlfCoor.z + 25*0.74

			Plf:SetCustomControlEnabled( true )
			Plf:SetCustomLinearVelocity( 0 )
			Plf:SetThrottle( 0 )
			Plf:SetCustomControlEnabled( false )

			FlyAround(6, 0, 25, 6, PlfCoor, PlfID, 1, 1)
			StartCinematic()

			AddCinematicMessage(31, 1 )

			TActivate("TRIGGER_THIEFDIE_cp")

   			CompleteQuest( "r1m3_FightWithThief" )

			AddQuestItem("quest_disk_2")
			
			TActivate("TRIGGER_LISAAFTERTHIEF")
			
			if IsQuestComplete("d_FindLisaOnSever_Quest") then
			AddQuestItem("quest_key_for_submarine")
			end

			trigger:Deactivate()
		</script>
	</trigger>
	<trigger Name="TRIGGER_THIEFDIE_cp" active="0">
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<script>
			GameFiltersUse()

			RestoreAllToleranceStatus()

			SetCameraBehindPlayerVehicle()

			trigger:Deactivate() 
		</script>
	</trigger>





	<trigger Name="TRIGGER_LISAAFTERTHIEF" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="SnatchLoc" />
		<script>
			TActivate( "RolikBegin_LISAAFTERTHIEF" )

   			FailQuest( "r1m3_MoveToOraculAfterThief" )

			RemoveQuestItem("quest_disk_1")
			RemoveQuestItem("quest_disk_2")
			RemoveQuestItem("quest_key_for_submarine")

			AddHistory( "r1_Lisa_Thief_00" )
			AddFadingMsgId( "fm_history_got" )
			trigger:Deactivate()
		</script>
	</trigger>





	<trigger Name="TRIGGER_ORACLEABOTPLATE" active="1">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="SnatchLoc" />
		<script>
			if  IsQuestTaken("r1m3_TW_OralceAboutAlien") and not(IsQuestComplete("r1m3_TW_OralceAboutAlien") or IsQuestFailed("r1m3_TW_OralceAboutAlien")) then
   				CompleteQuest( "r1m3_TW_OralceAboutAlien" )

				TActivate( "RolikBegin_ORACLEABOTPLATE" )

				AddHistory( "r1_Before_Fight_Aliens" )
				AddFadingMsgId( "fm_history_got" )

				trigger:Deactivate()
			end
		</script>
	</trigger>





	<trigger Name="TRIGGER_ORACLEAGRESSOR" active="1">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="OraculEndLoc" />
		<script>
			if  IsQuestTaken("r2m1_DeployBloks") and not(IsQuestComplete("r2m1_DeployBloks") or IsQuestFailed("r2m1_DeployBloks")) then
   				TakeQuest( "r1m3_DestroyOracle" )

				TActivate( "RolikBegin_ORACLEAGRESSOR" )

				trigger:Deactivate()
			end
		</script>
	</trigger>


	<trigger Name="PlayerCarDead" active="0">
		<event timeout="0.5" eventid="GE_TIME_PERIOD" />
		<script>
		if 2 > GetPlayerVehicle():GetHealth() then
			GetPlayerVehicle():Remove()
			SaveAllToleranceStatus(RS_NEUTRAL)

   			CompleteQuest( "r2m1_DeployBloks" )
   			CompleteQuest( "r1m3_DestroyOracle" )
   			CompleteQuest( "r4m2_NeutralizePlate" )

			SetWeather(0)

			PlayCustomMusic("mainmenu")

			Fly("end_game", CINEMATIC_NO_AIM, 0, 292, 1, 1 )
			StartCinematic()

			AddCinematicMessage( 77772, 0.1)
			AddCinematicMessage(5968, 0.1)
			AddCinematicMessage(5969, 0.1)
			AddCinematicMessage(5970, 0.1)
			AddCinematicMessage(5971, 0.1)

			TActivate("TRIGGER_ORACLEAGRESSORDIECINEMATIC")
			TActivate("TRIGGER_ORACLEAGRESSORDIE1")

			trigger:Deactivate()  
		end 
		</script>
	</trigger>


	<trigger Name="TRIGGER_ORACLEAGRESSORDIE" active="0">
		<event eventid="GE_OBJECT_DIE" ObjName="OracleFlyBoss" /> 
		<script>
			SaveAllToleranceStatus(RS_NEUTRAL)

   			CompleteQuest( "r2m1_DeployBloks" )
   			CompleteQuest( "r1m3_DestroyOracle" )
   			CompleteQuest( "r4m2_NeutralizePlate" )

			SetWeather(0)

			PlayCustomMusic("mainmenu")

			Fly("end_game", CINEMATIC_NO_AIM, 0, 317, 1, 1 )
			StartCinematic()

			AddCinematicMessage( 77771, 0.1)
			AddCinematicMessage(5968, 0.1)
			AddCinematicMessage(5969, 0.1)
			AddCinematicMessage(5970, 0.1)
			AddCinematicMessage(5971, 0.1)

			TActivate("TRIGGER_ORACLEAGRESSORDIECINEMATIC")

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="TRIGGER_ORACLEAGRESSORDIECINEMATIC" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>
			StopPlayingCustomMusic()

			if GetPlayerVehicle() then
				TActivate("trTotalGameCount")
			else
				ShowDeathMenu()
			end
			
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="ORACLEHACK" active="0">
		<event timeout="1" eventid="GE_TIME_PERIOD" />
		<script>
			local FV = GetEntityByName("OracleFlyBoss")
			if FV then
				FV:SetPosition( CVector(2517, 0, 6042) )
			end
		</script>
	</trigger>





	<trigger Name="TriggerBonnyTrap" active="0">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
			TeamCreate("BonnyTeam",1005,CVector(2176,293,6461), {"r1m1_molokovoz02"},CVector(2315,295,6407), 1)

			trigger:Deactivate()
		</script>
	</trigger>





	<trigger Name="TriggerLabirintCarCreate" active="0">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
			TeamCreate("OldTownOutsiderCar",1002,CVector(1387,259,3947), {"r1m3_molokovozInOldCity"}, nil, 1)

			local tv = GetEntityByName("OldTownOutsiderCar")
			if tv then
				tv:StackOpen()
				tv:SetDestination( CVector(1847,259,4119))
				tv:SetDestination( CVector(1781,259,3925))
				tv:SetDestination( CVector(1989,259,3742))
				tv:SetDestination( CVector(2415,259,4126))
				tv:SetDestination( CVector(1688,259,3769))
				tv:StackLoop()
				tv:StackClose()
			end

			TakeQuest("r1m3_OldTownOutsiderCar_Quest")
			
			TActivate("TriggerLabirintCarDie")

			trigger:Deactivate()
		</script>
	</trigger>





	<trigger Name="TriggerLabirintCarDie" active="0">
		<event eventid="GE_OBJECT_DIE" ObjName="OldTownOutsiderCar" />
		<script>
   			CompleteQuest( "r1m3_OldTownOutsiderCar_Quest" )

			trigger:Deactivate()
		</script>
	</trigger>





	<trigger Name="TriggerFindCircus" active="1">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="TheCircus" />
		<script>
   			CompleteQuest( "r1m3_CrazyManQuest" )

			trigger:Deactivate()
		</script>
	</trigger>





	<trigger Name="CARAVANTOR1M4" active="0">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
			TeamCreate("KARAVAN14",1010,CVector(6081, 260, 5915),{"r2m2_CaravanUral02","r1m2_hunter02","Fighter02","Molokovoz02"}, nil, 1)
			local vehP = GetEntityByName("KARAVAN14_vehicle_0")
			if vehP then
				vehP:SetExternalPathByName("karavan_path")
			end
			local vehPP = GetEntityByName("KARAVAN14_vehicle_1")
			if vehPP then
				vehPP:SetExternalPathByName("karavan_path")
			end
			local vehPPP = GetEntityByName("KARAVAN14_vehicle_2")
			if vehPPP then
				vehPPP:SetExternalPathByName("karavan_path")
			end
			local GoluBoyWagon = GetEntityByName("KARAVAN14_vehicle_3")
			if GoluBoyWagon then
				GoluBoyWagon:SetExternalPathByName("karavan_path")
				GoluBoyWagon:SetSkin(2)
			end
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="DeleteCaravanIfExists" active="0">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
			if VehP then
				VehP:Remove()
			end
			if VehPP then
				VehPP:Remove()
			end
			if VehPPP then
				VehPPP:Remove()
			end
			if GoluBoyWagon then
				GoluBoyWagon:Remove()
			end
		</script>
	</trigger>
				

	<trigger Name="triggerExitToMap11" active="1">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="ToR1M1" />
		<script>
			local Plf = GetPlayerVehicle()
			Plf:SetThrottle( 0 )
			Plf:SetCustomLinearVelocity( 0 )

			local PlfID = GetPlayerVehicleId()
			local PlfCoor = Plf:GetPosition()
			PlfCoor.y = PlfCoor.y + 25*0.74
			PlfCoor.z = PlfCoor.z + 25*0.74

			local b = SpawnMessageBox( "8801" )
			if b == 1 then
				local cWom = getObj("CircusMan")
				local cWomSC = cWom:GetSpokenCount()
				if cWomSC > 0 then
					local hs = GetEntityByName ("FIRE01")
					if hs then hs:Remove() end
					local hs = GetEntityByName ("FIRE02")
					if hs then hs:Remove() end
					local hs = GetEntityByName ("FIRE03")
					if hs then hs:Remove() end
					local hs = GetEntityByName ("FIRE04")
					if hs then hs:Remove() end
					local hs = GetEntityByName ("FIRE05")	
					if hs then hs:Remove() end
					local hs = GetEntityByName ("FIRE06")
					if hs then hs:Remove() end
				end

				TActivate("DeleteCaravanIfExists")
				PassToMap("r1m1", "FromR1M3", -1 )
			else
				SaveAllToleranceStatus(RS_NEUTRAL)

				FlyAround(1, 0, 25, 1, PlfCoor, PlfID, 1, 1 )
				StartCinematic()

				TActivate ("RolikExitToMap11")
				TActivate ("RolikENDExitToMap11")
			end
 		</script>
	</trigger>
	<trigger Name="RolikExitToMap11" active="0">
		<event eventid="GE_CINEMATIC_ENTER_FADE_IN" ObjName="Player1" />
		<script>
			CinemaFiltersUse()

			RotationPlayerByPoints(CVector(getPos("ToR1M1")), CVector(getPos("FromR1M1")))
			GetPlayerVehicle():SetGamePositionOnGround(CVector(getPos("FromR1M1")))

			trigger:Deactivate()    
		</script>
	</trigger>
	<trigger Name="RolikENDExitToMap11" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>
			GameFiltersUse()

			RestoreAllToleranceStatus()

			GetPlayerVehicle():SetGamePositionOnGround(CVector(getPos("FromR1M1")))

			TDeactivate( "RolikExitToMap11" )

			SetCameraBehindPlayerVehicle()

			trigger:Deactivate()
		</script>
	</trigger>






	<trigger Name="triggerExitToMap12" active="1">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="ToR1M2" />
		<script>
			local Plf = GetPlayerVehicle()
			Plf:SetThrottle( 0 )
			Plf:SetCustomLinearVelocity( 0 )

			local PlfID = GetPlayerVehicleId()
			local PlfCoor = Plf:GetPosition()
			PlfCoor.y = PlfCoor.y + 25*0.74
			PlfCoor.z = PlfCoor.z + 25*0.74

			if IsQuestTaken("d_FindBenInEast_Quest") or IsQuestTaken("d_FindLisaInMidragd_Quest") then 
				local b = SpawnMessageBox( "8801" )
				if b == 1 then
					local cWom = getObj("CircusMan")
					local cWomSC = cWom:GetSpokenCount()
					if cWomSC > 0 then
						local hs = GetEntityByName ("FIRE01")
						if hs then hs:Remove() end
						local hs = GetEntityByName ("FIRE02")
						if hs then hs:Remove() end
						local hs = GetEntityByName ("FIRE03")
						if hs then hs:Remove() end
						local hs = GetEntityByName ("FIRE04")
						if hs then hs:Remove() end
						local hs = GetEntityByName ("FIRE05")	
						if hs then hs:Remove() end
						local hs = GetEntityByName ("FIRE06")
						if hs then hs:Remove() end
					end

					TActivate("DeleteCaravanIfExists")
					PassToMap("r1m2", "FromR1M3", -1 )
				else
					SaveAllToleranceStatus(RS_NEUTRAL)

					FlyAround(1, 0, 25, 1, PlfCoor, PlfID, 1, 1 )
					StartCinematic()

					TActivate ("RolikExitToMap12")
					TActivate ("RolikENDExitToMap12")
				end
			else
				SaveAllToleranceStatus(RS_NEUTRAL)

				FlyAround(1, 0, 25, 6, PlfCoor, PlfID, 1, 1 )
				StartCinematic()

				AddCinematicMessage( 8802, 0.5 )

				TActivate ("RolikExitToMap12")
				TActivate ("RolikENDExitToMap12")
			end
 		</script>
	</trigger>
	<trigger Name="RolikExitToMap12" active="0">
		<event eventid="GE_CINEMATIC_ENTER_FADE_IN" ObjName="Player1" />
		<script>
			CinemaFiltersUse()

			RotationPlayerByPoints(CVector(getPos("ToR1M2")), CVector(getPos("FromR1M2")))
			GetPlayerVehicle():SetGamePositionOnGround(CVector(getPos("FromR1M2")))

			trigger:Deactivate()    
		</script>
	</trigger>
	<trigger Name="RolikENDExitToMap12" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>
			GameFiltersUse()

			RestoreAllToleranceStatus()

			GetPlayerVehicle():SetGamePositionOnGround(CVector(getPos("FromR1M2")))

			TDeactivate( "RolikExitToMap12" )

			SetCameraBehindPlayerVehicle()

			trigger:Deactivate()
		</script>
	</trigger>






	<trigger Name="triggerExitToMap14" active="1">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="ToR1M4" />
		<script>
			local Plf = GetPlayerVehicle()
			Plf:SetThrottle( 0 )
			Plf:SetCustomLinearVelocity( 0 )

			local PlfID = GetPlayerVehicleId()
			local PlfCoor = Plf:GetPosition()
			PlfCoor.y = PlfCoor.y + 25*0.74
			PlfCoor.z = PlfCoor.z + 25*0.74

			if IsQuestTaken("d_FindVrata_Quest") or IsQuestTaken("r1m4_TalkWithOldTraderAboutSecondDisk") then 
				local b = SpawnMessageBox( "8801" )
				if b == 1 then
					local cWom = getObj("CircusMan")
					if cWom then cWom:SetSpokenCount(1) end
					local hs = GetEntityByName ("FIRE01")
					if hs then hs:Remove() end
					local hs = GetEntityByName ("FIRE02")
					if hs then hs:Remove() end
					local hs = GetEntityByName ("FIRE03")
					if hs then hs:Remove() end
					local hs = GetEntityByName ("FIRE04")
					if hs then hs:Remove() end
					local hs = GetEntityByName ("FIRE05")	
					if hs then hs:Remove() end
					local hs = GetEntityByName ("FIRE06")
					if hs then hs:Remove() end
					
					TActivate("DeleteCaravanIfExists")
					PassToMap("r1m4", "FromR1M3", -1 )
				else
					SaveAllToleranceStatus(RS_NEUTRAL)

					FlyAround(1, 0, 25, 1, PlfCoor, PlfID, 1, 1 )
					StartCinematic()

					TActivate ("RolikExitToMap14")
					TActivate ("RolikENDExitToMap14")
				end
			else
				SaveAllToleranceStatus(RS_NEUTRAL)

				FlyAround(1, 0, 25, 6, PlfCoor, PlfID, 1, 1 )
				StartCinematic()

				AddCinematicMessage( 8802, 0.5 )

				TActivate ("RolikExitToMap14")
				TActivate ("RolikENDExitToMap14")
			end
 		</script>
	</trigger>
	<trigger Name="RolikExitToMap14" active="0">
		<event eventid="GE_CINEMATIC_ENTER_FADE_IN" ObjName="Player1" />
		<script>

			CinemaFiltersUse()

			RotationPlayerByPoints(CVector(getPos("ToR1M4")), CVector(getPos("FromR1M4")))
			GetPlayerVehicle():SetGamePositionOnGround(CVector(getPos("FromR1M4")))

			trigger:Deactivate()    
		</script>
	</trigger>
	<trigger Name="RolikENDExitToMap14" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>
			GameFiltersUse()

			RestoreAllToleranceStatus()

			GetPlayerVehicle():SetGamePositionOnGround(CVector(getPos("FromR1M4")))

			TDeactivate( "RolikExitToMap14" )

			SetCameraBehindPlayerVehicle()

			trigger:Deactivate()
		</script>
	</trigger>





	<trigger Name="triggerExitToMap21" active="1">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="ToR2M1" />
		<script>
			local Plf = GetPlayerVehicle()
			Plf:SetThrottle( 0 )
			Plf:SetCustomLinearVelocity( 0 )

			local PlfID = GetPlayerVehicleId()
			local PlfCoor = Plf:GetPosition()
			PlfCoor.y = PlfCoor.y + 25*0.74
			PlfCoor.z = PlfCoor.z + 25*0.74

			if IsQuestTaken("d_OpenTunel_Quest") then 
				local b = SpawnMessageBox( "8801" )
				if b == 1 then
				
					local cWom = getObj("CircusMan")
					if cWom then cWom:SetSpokenCount(1) end
					local hs = GetEntityByName ("FIRE01")
					if hs then hs:Remove() end
					local hs = GetEntityByName ("FIRE02")
					if hs then hs:Remove() end
					local hs = GetEntityByName ("FIRE03")
					if hs then hs:Remove() end
					local hs = GetEntityByName ("FIRE04")
					if hs then hs:Remove() end
					local hs = GetEntityByName ("FIRE05")	
					if hs then hs:Remove() end
					local hs = GetEntityByName ("FIRE06")
					if hs then hs:Remove() end

					PassToMap("r2m1", "FromR1M3", -1 )
				else
					SaveAllToleranceStatus(RS_NEUTRAL)

					FlyAround(1, 0, 25, 1, PlfCoor, PlfID, 1, 1 )
					StartCinematic()

					TActivate ("RolikExitToMap21")
					TActivate ("RolikENDExitToMap21")
				end
			else
				SaveAllToleranceStatus(RS_NEUTRAL)

				FlyAround(1, 0, 25, 6, PlfCoor, PlfID, 1, 1 )
				StartCinematic()

				AddCinematicMessage( 8803, 0.5 )

				TActivate ("RolikExitToMap21")
				TActivate ("RolikENDExitToMap21")
			end
 		</script>
	</trigger>
	<trigger Name="RolikExitToMap21" active="0">
		<event eventid="GE_CINEMATIC_ENTER_FADE_IN" ObjName="Player1" />
		<script>
			CinemaFiltersUse()

			RotationPlayerByPoints(CVector(getPos("ToR2M1")), CVector(getPos("FromR2M1")))
			GetPlayerVehicle():SetGamePositionOnGround(CVector(getPos("FromR2M1")))

			trigger:Deactivate()    
		</script>
	</trigger>
	<trigger Name="RolikENDExitToMap21" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>
			GameFiltersUse()

			RestoreAllToleranceStatus()

			GetPlayerVehicle():SetGamePositionOnGround(CVector(getPos("FromR2M1")))

			TDeactivate( "RolikExitToMap21" )

			SetCameraBehindPlayerVehicle()

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger	Name="trUpgradeDotsPlayer"	active="0">
		<event timeout="0.1" eventid="GE_TIME_PERIOD" />
		<script>
			TActivate("cinUpgradeDots")
				trigger:Deactivate()
		</script>
	</trigger>

	<trigger	Name="trUpgradeDotsPlayer2"	active="0">
		<event timeout="0.1" eventid="GE_TIME_PERIOD" />
		<script>
			CreateNewBreakableObject("staticAutoGun04","Cras1", 1100, CVector(5904.864, 260.077, 7243.452), Quaternion(-0.003, -0.985, 0.001, 0.172))
			CreateNewBreakableObject("staticAutoGun04","Cras2", 1100, CVector(5934.791, 259.969, 7295.580), Quaternion(-0.007, -0.809, -0.006, -0.587))
			CreateNewBreakableObject("staticAutoGun04","Cras3", 1100, CVector(5938.520, 259.336, 7336.675), Quaternion(-0.011, -0.754, -0.000, -0.657))
			CreateNewBreakableObject("staticAutoGun04","Cras4", 1100, CVector(5839.983, 258.917, 7319.485), Quaternion(-0.002, 0.772, -0.008, -0.636))
			CreateNewBreakableObject("staticAutoGun04","Cras5", 1100, CVector(5837.947, 259.027, 7274.979), Quaternion(-0.029, 0.814, 0.012, -0.579))
				trigger:Deactivate()
		</script>
	</trigger>

	<trigger	Name="trUpgradeVillagePlayer"	active="0">
		<event timeout="0.1" eventid="GE_TIME_PERIOD" />
		<script>
			TActivate("cinUpgradeVillage")
				trigger:Deactivate()
		</script>
	</trigger>

	<trigger	Name="trUpgradeVillagePlayer2"	active="0">
		<event timeout="0.1" eventid="GE_TIME_PERIOD" />
		<script>
			CreateNewDummyObject( "house1", "vilup1_h1", -1, -1, CVector(5914.667, 258.564, 7264.594), Quaternion(0.001, 0.685, -0.003, -0.728), 0)
			CreateNewDummyObject( "house2", "vilup1_h2", -1, -1, CVector(5914.448, 258.516, 7293.682), Quaternion(-0.003, 0.506, 0.000, -0.863), 0)
			CreateNewDummyObject( "house3", "vilup1_h3", -1, -1, CVector(5858.287, 258.564, 7262.000), Quaternion(0.002, 0.420, 0.006, 0.908), 0)
			CreateNewDummyObject( "petrolstation", "vilup1_z1", -1, -1, CVector(5885.676, 258.103, 7320.918), Quaternion(0.003, 0.0, 0.003, 0.161), 0)

			local Workshop = GetEntityByName("PlayerVillage_Workshop")
			local Repository = Workshop:GetRepositoryByTypename("Vehicles")
			Repository:AddItems("BugForSale", 1)

			local shop = GetEntityByName("PlayerVillage_Shop")
			local Repository = shop:GetRepositoryByTypename("GunsAndGadgets")
			Repository:AddItems("rapier01", 2)
			Repository:AddItems("kord01", 1)
			Repository:AddItems("vulcan01", 1)
			Repository:AddItems("kpvt01", 1)
				trigger:Deactivate()
		</script>
	</trigger>

	<trigger	Name="trUpdateShop"	active="0">
		<event timeout="0.1" eventid="GE_TIME_PERIOD" />
		<script>
		local gunorvehicle = random (2)
		if gunorvehicle == 1 then
			local randomupdateshop = random(10)
			local shop = GetEntityByName("PlayerVillage_Shop")
			local Repository = shop:GetRepositoryByTypename("GunsAndGadgets")
			if randomupdateshop == 1 then
				Repository:AddItems("rapier01", 2)
				Repository:AddItems("kord01", 1)
				Repository:AddItems("vulcan01", 1)
				Repository:AddItems("kpvt01", 1)
				SpawnMessageBox("1000001")
			elseif randomupdateshop == 2 then
				Repository:AddItems("hornet01", 2)
				Repository:AddItems("kord01", 1)
				Repository:AddItems("specter01", 1)
				Repository:AddItems("vector01", 1)
				SpawnMessageBox("1000002")
			elseif randomupdateshop == 3 then
				Repository:AddItems("vector01", 3)
				Repository:AddItems("kpvt01", 1)
				SpawnMessageBox("1000003")
			elseif randomupdateshop == 4 then
				Repository:AddItems("octopus01", 1)
				Repository:AddItems("pkt01", 1)
				Repository:AddItems("vector01", 1)
				Repository:AddItems("rocketLauncher", 1)
				SpawnMessageBox("1000004")
			elseif randomupdateshop == 5 then
				Repository:AddItems("rapier01", 1)
				Repository:AddItems("kord01", 1)
				Repository:AddItems("cyclops01", 1)
				Repository:AddItems("kpvt01", 1)
				SpawnMessageBox("1000005")
			elseif randomupdateshop == 6 then
				Repository:AddItems("hornet01", 1)
				Repository:AddItems("kord01", 1)
				Repository:AddItems("pkt01", 1)
				Repository:AddItems("specter01", 1)
				SpawnMessageBox("1000006")
			elseif randomupdateshop == 7 then
				Repository:AddItems("kpvt01", 1)
				Repository:AddItems("flag01", 1)
				Repository:AddItems("bumblebee01", 1)
				Repository:AddItems("kord01", 1)
				SpawnMessageBox("1000007")
			elseif randomupdateshop == 8 then
				Repository:AddItems("hornet01", 1)
				Repository:AddItems("omega01", 1)
				Repository:AddItems("bumblebee01", 1)
				Repository:AddItems("rainmetal01", 1)
				SpawnMessageBox("1000008")
			elseif randomupdateshop == 9 then
				Repository:AddItems("odin01", 1)
				Repository:AddItems("maxim01", 1)
				Repository:AddItems("fagot01", 1)
				Repository:AddItems("elephant01", 1)
				SpawnMessageBox("1000009")
			elseif randomupdateshop == 10 then
				Repository:AddItems("omega01", 1)
				Repository:AddItems("bumblebee01", 1)
				Repository:AddItems("vector01", 1)
				Repository:AddItems("rocketLauncher", 1)
				SpawnMessageBox("1000010")
			end
		elseif gunorvehicle == 2 then
			local randomupdateshop = random(10)
			local shop = GetEntityByName("PlayerVillage_Workshop")
			local Repository = shop:GetRepositoryByTypename("Vehicles")
			if randomupdateshop == 1 then
				Repository:AddItems("BugForSale", 1)
				SpawnMessageBox("100001")
			elseif randomupdateshop == 2 then
				Repository:AddItems("ScoutForSale", 1)
				SpawnMessageBox("100002")
			elseif randomupdateshop == 3 then
				Repository:AddItems("UralForSale", 1)
				SpawnMessageBox("100003")
			elseif randomupdateshop == 4 then
				Repository:AddItems("HunterForSale", 1)
				SpawnMessageBox("100004")
			elseif randomupdateshop == 5 then
				Repository:AddItems("FighterForSale", 1)
				SpawnMessageBox("100005")
			elseif randomupdateshop == 6 then
				Repository:AddItems("Sml1ForSale", 2)
				SpawnMessageBox("100006")
			elseif randomupdateshop == 7 then
				Repository:AddItems("MolokovozForSale", 1)
				SpawnMessageBox("100007")
			elseif randomupdateshop == 8 then
				Repository:AddItems("CruiserForSale", 1)
				SpawnMessageBox("100008")
			elseif randomupdateshop == 9 then
				Repository:AddItems("Tank01", 1)
				SpawnMessageBox("100009")
			elseif randomupdateshop == 10 then
				Repository:AddItems("BelazForSale", 1)
				SpawnMessageBox("100010")
			end
		end
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger	Name="trUpdateWorkShop1"	active="0">
		<event timeout="0.1" eventid="GE_TIME_PERIOD" />
		<script>
			local randomupdateworkshop = random(10)
			local Workshop = GetEntityByName("PlayerVillage_Workshop")
			local Repository = Workshop:GetRepositoryByTypename("CabinsAndBaskets")
			if randomupdateworkshop == 1 then
				Repository:AddItems("bugCab02", 1)
				SpawnMessageBox("10001")
			elseif randomupdateworkshop == 2 then
				Repository:AddItems("bugCab03", 1)
				SpawnMessageBox("10102")
			elseif randomupdateworkshop == 3 then
				Repository:AddItems("bugCargo02", 1)
				SpawnMessageBox("10103")
			elseif randomupdateworkshop == 4 then
				Repository:AddItems("bugCargo03", 1)
				SpawnMessageBox("10104")
			elseif randomupdateworkshop == 5 then
				Repository:AddItems("molokovozCab02", 1)
				SpawnMessageBox("10105")
			elseif randomupdateworkshop == 6 then
				Repository:AddItems("MolokovozCab03", 1)
				SpawnMessageBox("10106")
			elseif randomupdateworkshop == 7 then
				Repository:AddItems("molokovozCargo02", 1)
				SpawnMessageBox("10107")
			elseif randomupdateworkshop == 8 then
				Repository:AddItems("molokovozCargo03", 1)
				SpawnMessageBox("10108")
			elseif randomupdateworkshop == 9 then
				Repository:AddItems("uralCab03", 1)
				SpawnMessageBox("10003")
			elseif randomupdateworkshop == 10 then
				Repository:AddItems("uralCab02", 1)
				SpawnMessageBox("10002")
			end
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger	Name="trUpdateWorkShop2"	active="0">
		<event timeout="0.1" eventid="GE_TIME_PERIOD" />
		<script>
			local randomupdateworkshop = random(22)
			local Workshop = GetEntityByName("PlayerVillage_Workshop")
			local Repository = Workshop:GetRepositoryByTypename("CabinsAndBaskets")
			if randomupdateworkshop == 1 then
				Repository:AddItems("bugCab02", 1)
				SpawnMessageBox("10001")
			elseif randomupdateworkshop == 2 then
				Repository:AddItems("uralCab02", 1)
				SpawnMessageBox("10002")
			elseif randomupdateworkshop == 3 then
				Repository:AddItems("uralCab03", 1)
				SpawnMessageBox("10003")
			elseif randomupdateworkshop == 4 then
				Repository:AddItems("uralCab04", 1)
				SpawnMessageBox("10004")
			elseif randomupdateworkshop == 5 then
				Repository:AddItems("uralCab05", 1)
				SpawnMessageBox("10005")
			elseif randomupdateworkshop == 6 then
				Repository:AddItems("belazCab02", 1)
				SpawnMessageBox("10006")
			elseif randomupdateworkshop == 7 then
				Repository:AddItems("belazCab03", 1)
				SpawnMessageBox("10007")
			elseif randomupdateworkshop == 8 then
				Repository:AddItems("belazCab04", 1)
				SpawnMessageBox("10008")
			elseif randomupdateworkshop == 9 then
				Repository:AddItems("belazCab05", 1)
				SpawnMessageBox("10009")
			elseif randomupdateworkshop == 10 then
				Repository:AddItems("mirotvorecCab02", 1)
				SpawnMessageBox("10010")
			elseif randomupdateworkshop == 11 then
				Repository:AddItems("mirotvorecCab03", 1)
				SpawnMessageBox("10011")
			elseif randomupdateworkshop == 12 then
				Repository:AddItems("uralCargo02", 1)
				SpawnMessageBox("20001")
			elseif randomupdateworkshop == 13 then
				Repository:AddItems("uralCargo03", 1)
				SpawnMessageBox("20002")
			elseif randomupdateworkshop == 14 then
				Repository:AddItems("uralCargo04", 1)
				SpawnMessageBox("20003")
			elseif randomupdateworkshop == 15 then
				Repository:AddItems("uralCargo05", 1)
				SpawnMessageBox("20004")
			elseif randomupdateworkshop == 16 then
				Repository:AddItems("belazCargo02", 1)
				SpawnMessageBox("20005")
			elseif randomupdateworkshop == 17 then
				Repository:AddItems("belazCargo03", 1)
				SpawnMessageBox("20006")
			elseif randomupdateworkshop == 18 then
				Repository:AddItems("belazCargo04", 1)
				SpawnMessageBox("20007")
			elseif randomupdateworkshop == 19 then
				Repository:AddItems("belazCargo05", 1)
				SpawnMessageBox("20008")
			elseif randomupdateworkshop == 20 then
				Repository:AddItems("mirotvorecCargo02", 1)
				SpawnMessageBox("20009")
			elseif randomupdateworkshop == 21 then
				Repository:AddItems("mirotvorecCargo03", 1)
				SpawnMessageBox("20010")
			end
			trigger:Deactivate()
		</script>
	</trigger>
	
	<trigger Name="trPlayerInQuestion1" active="1">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="locRandomQuest1" />
		<script>
			getObj("locRandomQuest1Ico"):SetProperty("Active",0)
			TActivate("Question1Cin")
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger	Name="Question1SpawnItem"	active="0">
		<event	timeout="0.1"		eventid="GE_TIME_PERIOD" />
		<script>
			local art1 = CreateNewSgNodeObject( "cargo", "or_artefact1", -1, -1, CVector(1575.088, 276.596, 7246.217), Quaternion(0, 0, 0, 1), 1)
			TActivate("trRotateArt")
			TActivate("trPlayerInQuestion1Final")

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger	Name="trRotateArt"	active="0">
		<event	timeout="0.1"		eventid="GE_TIME_PERIOD" />
		<script>
			for i=1,2 do
			    local art = getObj("or_artefact"..i)
			    local zq = 	Quaternion(0, 0, 0, 1)
			    zq:RotY(RAD(7))
			    if art then
			    	local rot = art:GetRotation()
            	    art:SetRotation(zq*rot)
				end
			end
		</script>
	</trigger>

	<trigger Name="trPlayerInQuestion1Final" active="1">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="locRandomQuest1Final" />
		<script>
			TDeactivate("trRotateArt")
			getObj("or_artefact1"):Remove()
			SpawnMessageBox("8806")
			TakeQuest("RandomQuestR1M3_1")
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trTotalGameCount" active="0">
		<event	timeout="0.01"		eventid="GE_TIME_PERIOD" />
		<script>

			if CountPlayerProgress()==33 then
				SpawnMessageBox( "888" )
				local b = SpawnMessageBox( "889" )
				if b == 1 then
					PassToMap("r1m0", "FromR1M4", -1 )
				else
					ShowDeathMenu()
				end
			else
				ShowDeathMenu()
			end


			trigger:Deactivate()
		</script>
	</trigger>
</triggers>